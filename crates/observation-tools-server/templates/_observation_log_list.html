<div
  id="observations-list"
  hx-trigger="every 1s"
  hx-get="{{ params.refresh_url }}"
  hx-select="#observations-list"
  hx-swap="outerHTML"
>
  {% if params.observations %}
    <div
      class="font-mono text-sm bg-neutral-900 dark:bg-black rounded border border-neutral-700 overflow-hidden"
    >
      {% for obs in params.observations %}
        <a
          id="observations-list-{{ obs.id }}"
          data-testid="ObservationListItemLink"
          href="{{ base_path }}?obs={{ obs.id }}"
          class="block px-3 py-1.5 hover:bg-neutral-800 cursor-pointer border-b border-neutral-800 last:border-b-0 {% if selected_observation and selected_observation.id == obs.id %}bg-neutral-800{% endif %}"
        >
          <div data-testid="ObservationListItem" class="flex items-start gap-3">
            <span class="text-neutral-500 shrink-0">{{ obs.created_at }}</span>
            <span
              class="shrink-0 w-14 text-right {% if obs.log_level == 'Error' %}text-red-400{% elif obs.log_level == 'Warning' %}text-yellow-400{% elif obs.log_level == 'Info' %}text-blue-400{% elif obs.log_level == 'Debug' %}text-green-400{% else %}text-neutral-500{% endif %}"
            >{{ obs.log_level }}</span
            >
            <span class="text-neutral-400 shrink-0">
                      {% if obs.source %}
                        {{ obs.source.file }}:{{ obs.source.line }}
                      {% else %}
                        -
                      {% endif %}
                    </span>
            <span class="text-neutral-200 truncate"
            >
              {% if obs.observation_type == 'LogEntry' %}
                {{ obs.payload.data[:200] }}{% if
                obs.payload.data|length > 200 %}
                  ...
                {% endif %}
              {% else %}
                {{ obs.name }}:
                {{ obs.payload.data[:100] }}{% if obs.payload.data|length > 100 %}...{% endif %}
              {% endif %}
            </span>
          </div>
        </a>
      {% endfor %}
    </div>
    {% if params.total_count %}
      <div class="mt-4 pt-4 border-t border-black dark:border-neutral-200">
        <p data-testid="PaginationInfo" class="mb-2">
                  <span class="text-neutral-600 dark:text-neutral-400 text-sm">
                    showing {{ params.offset + 1 }}-{{ params.offset + params.observations|length }} of {{ params.total_count }}
                    (page {{ params.page }})
                  </span>
        </p>
        <div class="flex gap-2">
          <button
            data-testid="PaginationPrev"
            {% if params.previous_page_url %}
            href="{{ params.previous_page_url }}"
            {% else %}
            disabled
            {% endif %}
            class="font-mono text-sm px-2 py-1 border border-black dark:border-neutral-200 bg-white dark:bg-neutral-800 text-black dark:text-neutral-200 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400"
          >
            ← prev
          </button>
          <button
            data-testid="PaginationNext"
            {% if params.next_page_url %}
            href="{{ params.next_page_url }}"
            {% else %}
            disabled
            {% endif %}
            class="font-mono text-sm px-2 py-1 border border-black dark:border-neutral-200 bg-white dark:bg-neutral-800 text-black dark:text-neutral-200 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400"
          >
            next →
          </button>
        </div>
      </div>
    {% endif %}
  {% else %}
    <p>no observations found.</p>
  {% endif %}
</div>
