{% from "_nav_bar.html" import nav %}
{% from "_macros.html" import breadcrumbs %}
{% extends "base.html" %}
{% block title %}{% if observation %}{{ observation.name }}{% else %}Waiting for observation...{% endif %}{% endblock %}
{% block content %}
  {{ nav() }}
  <main class="p-8">
    <div
      id="observation-page"
      hx-get="/exe/{{ execution_id }}/obs/{{ observation_id }}"
      hx-trigger="every 2s"
      hx-select="#observation-page"
      hx-swap="innerHTML"
    >
      {% if observation %}
        {{ breadcrumbs([
          {"href": "/", "text": "home"},
          {"href": "/exe", "text": "executions"},
          {"href": "/exe/" ~ observation.execution_id, "text": observation.execution_id},
          {"text": observation.name}
        ]) }}

        {% include "_observation_content.html" %}
      {% else %}
        <div>
          {{ breadcrumbs([
            {"href": "/", "text": "home"},
            {"href": "/exe", "text": "executions"},
            {"href": "/exe/" ~ execution_id, "text": execution_id},
            {"text": "waiting..."}
          ]) }}

          <h1 class="text-2xl font-bold my-4 text-neutral-400">Waiting for observation...</h1>

          <p class="mb-2">
            <span class="text-neutral-600 dark:text-neutral-400 text-sm">id:</span>
            <code class="bg-neutral-100 dark:bg-neutral-800 text-neutral-400 px-1 py-0.5"
              >{{ observation_id }}</code
            >
          </p>
          <p class="text-neutral-600 dark:text-neutral-400">
            This observation has not been received yet. The page will automatically refresh when
            data arrives.
          </p>
        </div>
      {% endif %}
    </div>
  </main>
{% endblock %}
