<div class="flex flex-col h-full">
  <div class="flex-shrink-0">
    <h1 class="text-2xl font-bold my-4">{{ observation.name }}</h1>

    <p class="mb-2"><span class="text-neutral-600 dark:text-neutral-400 text-sm">id:</span> <code data-testid="ObservationId" class="bg-neutral-100 dark:bg-neutral-800 text-black dark:text-neutral-200 px-1 py-0.5">{{ observation.id }}</code></p>
    <p class="mb-2"><span class="text-neutral-600 dark:text-neutral-400 text-sm">created:</span> {{ observation.created_at }}</p>

    {% if observation.source %}
    <p class="mb-2">
      <span class="text-neutral-600 dark:text-neutral-400 text-sm">source:</span>
      <code class="bg-neutral-100 dark:bg-neutral-800 text-black dark:text-neutral-200 px-1 py-0.5"
        ><span data-testid="ObservationSourceFile">{{ observation.source.file }}</span>:<span
          data-testid="ObservationSourceLine"
          >{{ observation.source.line }}</span
        ></code
      >
    </p>
    {% endif %} {% if observation.parent_span_id %}
    <p class="mb-2"><span class="text-neutral-600 dark:text-neutral-400 text-sm">parent span:</span> <code class="bg-neutral-100 dark:bg-neutral-800 text-black dark:text-neutral-200 px-1 py-0.5">{{ observation.parent_span_id }}</code></p>
    {% endif %} {% if observation.labels %}
    <p data-testid="ObservationLabels" class="mb-2">
      <span class="text-neutral-600 dark:text-neutral-400 text-sm">labels:</span> {{ observation.labels|join(", ") }}
    </p>
    {% endif %} {% if observation.metadata %}
    <h3 class="text-base font-bold my-2">metadata</h3>
    <ul class="list-none">
      {% for key, value in observation.metadata %}
      <li class="my-2">{{ key }}: {{ value }}</li>
      {% endfor %}
    </ul>
    {% endif %}

    <hr class="border-t border-black dark:border-neutral-200 my-4" />

    <h2 class="text-xl font-bold my-4">payload</h2>
    <p class="mb-2"><span class="text-neutral-600 dark:text-neutral-400 text-sm">type:</span> {{ observation.payload.mime_type }}</p>
    <p class="mb-2"><span class="text-neutral-600 dark:text-neutral-400 text-sm">size:</span> {{ observation.payload.size }} bytes</p>
    <p class="mb-2">
      <a
        href="/api/exe/{{ observation.execution_id }}/obs/{{ observation.id }}/content"
        target="_blank"
        rel="noopener noreferrer"
        class="underline text-black dark:text-neutral-200 hover:text-blue-600 dark:hover:text-blue-400"
      >Open raw content in new tab</a>
    </p>
  </div>

  {% if observation.payload.size > display_threshold %}
  <div class="flex-grow">
    <p data-testid="ObservationPayload">Payload is too large to display inline.</p>
  </div>
  {% else %}
  <pre
    data-testid="ObservationPayload"
    style="
      flex-grow: 1;
      min-height: 0;
      overflow: auto;
      border: 1px solid var(--border-color);
      padding: 1rem;
      margin: 0;
      background-color: var(--code-bg);
    "
  >
{{ observation.payload.data|unescape }}</pre
  >
  {% endif %}
</div>
